package com.zumbaapp.servlet.db;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;

import com.zumbaapp.servlet.model.Classes;
import com.zumbaapp.servlet.model.Participant;

public class DB {

		Connection connection;
		PreparedStatement preparedStatement;
		
		public DB() {
			try {
				Class.forName("com.mysql.cj.jdbc.Driver");
				System.out.println("[DB] Driver Loaded");
				
				connection = DriverManager.getConnection("jdbc:mysql://127.0.0.1:3306/zumba_management", "root", "201155876");
				System.out.println("[DB] Connection created");
			}
			catch(Exception e) {
				System.out.println("Something went wrong: " + e);
			}
		}
			
		public void closeConnection() {
			try {
				connection.close();
				System.out.println("[DB] Connection to DB closed");
			}
			catch(Exception e) {
				System.out.println("Something went wrong: " + e);
			}
		}
		
		public int addClasses(Classes classes) {
			int result = 0;
			
			try {
			String sql = "INSERT INTO Classes VALUES (null, ?, ?, ?, ?, ?, ?)";
			preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setString(1, classes.name);
			preparedStatement.setString(2, classes.session);
			preparedStatement.setString(3, classes.date);
			preparedStatement.setString(4, classes.startTime);
			preparedStatement.setString(5, classes.endTime);
			preparedStatement.setString(6, classes.location);
			
			result = preparedStatement.executeUpdate();
			
			}
			catch(Exception e) {
				System.out.println("Something went wrong: " + e);
			}
			return result;
		}
		
		public int addParticipant(Participant participant) {
			int result = 0;
			
			try {
			String sql = "INSERT INTO Participant VALUES (null, ?, ?, ?, ?, ?)";
			preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setString(1, participant.firstName);
			preparedStatement.setString(2, participant.lastName);
			preparedStatement.setString(3, participant.email);
			preparedStatement.setString(4, participant.phone);
			preparedStatement.setString(5, participant.zumbaClass);
			
			result = preparedStatement.executeUpdate();
			
			}
			catch(Exception e) {
				System.out.println("Something went wrong: " + e);
			}
			return result;
		}
}
